<!DOCTYPE html> 
<html lang="ja"> 
<head> 
<meta charset=utf-8>
<title>ドラッグ＆ドロップ　サンプル</title>
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
<style>
#screen_parts {
  /*単なるスタイリング*/
  width:100px; height:500px; margin:20px; background-color:#FF9966; border:1px solid #cc3333;
  float: left;
}
#dropbox {
  /*単なるスタイリング*/
  width:1000px; height:500px; margin:20px; background-color:#CCFF66; border:1px solid #00cc00;
  /*以下はwebkit系ブラウザでドラッグ＆ドロップを動かすための指定（ブラウザのサポートが進めば、必要なくなると思われます）*/
  -khtml-user-drag: element;
  float: left;
}
.label_parts {
  /*単なるスタイリング*/
  background-color:#CCFF66;
  border-style:none
}
</style>
<script>
$(function() {
    $( ".draggable" ).draggable({
      helper: 'clone',
      revert: 'invalid',
    });
    $( "#dropbox" ).droppable({
      "hoverClass":'gray',
      drop: function( event, ui ) {
        var div_elm =$("<div></div>")
        div_elm.addClass("dragged");
        if (ui.draggable.hasClass("label")) {
            var add_elm =$("<input>", {type: "text",
                                       "maxlength": "5",
                                       "size":"10",
                                       "value":"ラベル"
                                       });
            add_elm.addClass("label_parts");
            add_elm =div_elm.html(add_elm);
            add_elm.prependTo(this).css({"position":"absolute",top:event.clientY,left:event.clientX});
        }
        else if (ui.draggable.hasClass("text")) {
            var add_elm =$("<input>", {type: "text",
                                       "maxlength": "5",
                                       "size":"10",
                                       "disabled":"true"
                                       });
           add_elm.addClass("text_parts");
           add_elm =div_elm.html(add_elm);
           add_elm.prependTo(this).css({"position":"absolute",top:event.clientY,left:event.clientX});
        }
        //add_elm.addClass("dragged");
        $( ".dragged" ).draggable({
          cancel: null
        });
      }
    });
  });
</script>
</head>
<body>

<p>画面部品</p>
<div id="screen_parts">
 <ul class="parts_list" itemscope="">
<li class="draggable droppable label" itemprop="LabelControl">
 <span class="label-image-gaia">ラベル</span>
</li>
<li class="draggable droppable text" itemprop="StringTextControl">
 <span class="text-image-gaia">文字列 (1行)</span>
</li>
</ul>
</div>

<div id="dropbox">
</div>

</body>
</html>
